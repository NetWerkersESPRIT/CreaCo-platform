{% extends 'base.html.twig' %}

{% block title %}{{ ressource.nom }} | CreaCo{% endblock %}

{% block body %}
<div class="w-full px-6 py-6 mx-auto">
    
    <!-- Breadcrumbs -->
    <nav class="relative flex flex-wrap items-center justify-between px-0 py-2 mx-6 transition-all shadow-none duration-250 ease-soft-in rounded-2xl lg:flex-nowrap lg:justify-start">
        <div class="flex items-center justify-between w-full px-4 py-1 mx-auto flex-wrap-inherit">
            <nav>
                <ol class="flex flex-wrap pt-1 mr-12 bg-transparent rounded-lg sm:mr-16">
                    <li class="text-sm leading-normal">
                        <a class="opacity-50 text-slate-700" href="{{ path('app_front_home') }}">Courses</a>
                    </li>
                    <li class="text-sm pl-2 capitalize leading-normal text-slate-700 before:float-left before:pr-2 before:text-gray-600 before:content-['/']">
                        <a class="opacity-50 text-slate-700" href="{{ path('app_front_course', {'id': ressource.cours.id}) }}">{{ ressource.cours.titre }}</a>
                    </li>
                    <li class="text-sm pl-2 capitalize leading-normal text-slate-700 before:float-left before:pr-2 before:text-gray-600 before:content-['/']" aria-current="page">{{ ressource.nom }}</li>
                </ol>
                <h6 class="mb-0 font-bold capitalize">{{ ressource.nom }}</h6>
            </nav>
        </div>
    </nav>

    <!-- Resource Header -->
    <div class="flex flex-wrap -mx-3 mb-6">
        <div class="w-full max-w-full px-3">
            <div class="relative flex flex-col min-w-0 break-words bg-white shadow-soft-xl rounded-2xl bg-clip-border">
                <div class="p-6 border-b border-gray-200">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center gap-4">
                            <div class="inline-flex items-center justify-center w-16 h-16 text-white rounded-xl shadow-soft-2xl
                                {% if ressource.type|upper == 'PDF' %}bg-gradient-to-tl from-red-600 to-rose-400
                                {% elseif ressource.type|upper == 'VIDEO' %}bg-gradient-to-tl from-red-500 to-orange-400
                                {% elseif ressource.type|upper == 'IMAGE' %}bg-gradient-to-tl from-purple-700 to-pink-500
                                {% else %}bg-gradient-to-tl from-slate-600 to-slate-300{% endif %}">
                                {% if ressource.type|upper == 'PDF' %}
                                    <i class="fas fa-file-pdf text-2xl"></i>
                                {% elseif ressource.type|upper == 'VIDEO' %}
                                    <i class="fas fa-video text-2xl"></i>
                                {% elseif ressource.type|upper == 'IMAGE' %}
                                    <i class="fas fa-image text-2xl"></i>
                                {% else %}
                                    <i class="fas fa-file text-2xl"></i>
                                {% endif %}
                            </div>
                            <div>
                                <h4 class="mb-1 font-bold text-slate-700">{{ ressource.nom }}</h4>
                                <div class="flex items-center gap-3 text-sm text-slate-500">
                                    <span class="badge rounded-pill bg-gradient-to-tl {{ ressource.type|upper == 'PDF' ? 'from-red-600 to-rose-400' : (ressource.type|upper == 'VIDEO' ? 'from-red-500 to-orange-400' : (ressource.type|upper == 'IMAGE' ? 'from-purple-700 to-pink-500' : 'from-slate-600 to-slate-300')) }} text-white text-xs font-bold px-3 py-1">{{ ressource.type }}</span>
                                    <span><i class="fas fa-calendar-alt mr-1"></i>{{ ressource.dateDeCreation ? ressource.dateDeCreation|date('d F Y') : '-' }}</span>
                                </div>
                            </div>
                        </div>
                        <a href="{{ path('app_front_course', {'id': ressource.cours.id}) }}" class="inline-block px-6 py-3 font-bold text-center uppercase transition-all bg-transparent border border-solid rounded-lg cursor-pointer leading-pro text-xs ease-soft-in shadow-none tracking-tight-rem hover:scale-102 active:opacity-85 border-slate-700 text-slate-700 hover:bg-slate-700 hover:text-white">
                            <i class="fas fa-arrow-left mr-1"></i>
                            Back to Course
                        </a>
                    </div>
                </div>

                <!-- Resource Content -->
                <div class="p-6">
                    {% set is_youtube = (ressource.type|upper == 'VIDEO' and ressource.url and ('youtube.com' in ressource.url or 'youtu.be' in ressource.url)) %}
                    {% set video_id = '' %}

                    {% if is_youtube %}
                        {% if 'v=' in ressource.url %}
                            {% set video_id = ressource.url|split('v=')|last|split('&')|first %}
                        {% elseif 'youtu.be' in ressource.url %}
                            {% set video_id = ressource.url|split('/')|last %}
                        {% endif %}

                        {# YouTube Video Embed #}
                        <div class="w-full relative overflow-hidden rounded-2xl bg-black mb-6" style="padding-top: 56.25%;">
                            <iframe class="absolute top-0 left-0 w-full h-full" src="https://www.youtube.com/embed/{{ video_id }}" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>
                        </div>
                        <div class="text-center">
                            <a href="{{ ressource.url }}" target="_blank" class="inline-block px-6 py-3 font-bold text-center uppercase transition-all bg-gradient-to-tl from-purple-700 to-pink-500 text-white rounded-lg cursor-pointer leading-pro text-xs ease-soft-in shadow-soft-md hover:scale-102 active:opacity-85">
                                <i class="fab fa-youtube mr-2"></i>
                                Watch on YouTube
                            </a>
                        </div>

                    {% elseif ressource.type|upper == 'PDF' and ressource.url %}
                        {# PDF Viewer #}
                        <div class="w-full h-screen-75 mb-6">
                            <iframe src="{{ ressource.url }}" class="w-full h-full rounded-2xl border-2 border-gray-200" frameborder="0"></iframe>
                        </div>
                        <div class="text-center">
                            <a href="{{ ressource.url }}" target="_blank" download class="inline-block px-6 py-3 font-bold text-center uppercase transition-all bg-gradient-to-tl from-red-600 to-rose-400 text-white rounded-lg cursor-pointer leading-pro text-xs ease-soft-in shadow-soft-md hover:scale-102 active:opacity-85">
                                <i class="fas fa-download mr-2"></i>
                                Download PDF
                            </a>
                        </div>

                    {% elseif ressource.type|upper == 'IMAGE' and ressource.url %}
                        {# Image Display #}
                        <div class="w-full mb-6 text-center">
                            <img src="{{ ressource.url }}" alt="{{ ressource.nom }}" class="max-w-full h-auto rounded-2xl shadow-soft-2xl mx-auto">
                        </div>
                        <div class="text-center">
                            <a href="{{ ressource.url }}" target="_blank" download class="inline-block px-6 py-3 font-bold text-center uppercase transition-all bg-gradient-to-tl from-purple-700 to-pink-500 text-white rounded-lg cursor-pointer leading-pro text-xs ease-soft-in shadow-soft-md hover:scale-102 active:opacity-85">
                                <i class="fas fa-download mr-2"></i>
                                Download Image
                            </a>
                        </div>

                    {% elseif ressource.type|upper == 'VIDEO' and ressource.url %}
                        {# Local Video Player #}
                        <div class="w-full mb-6">
                            <video controls class="w-full rounded-2xl shadow-soft-2xl">
                                <source src="{{ ressource.url }}" type="video/mp4">
                                Your browser does not support the video tag.
                            </video>
                        </div>
                        <div class="text-center">
                            <a href="{{ ressource.url }}" target="_blank" download class="inline-block px-6 py-3 font-bold text-center uppercase transition-all bg-gradient-to-tl from-red-500 to-orange-400 text-white rounded-lg cursor-pointer leading-pro text-xs ease-soft-in shadow-soft-md hover:scale-102 active:opacity-85">
                                <i class="fas fa-download mr-2"></i>
                                Download Video
                            </a>
                        </div>

                    {% elseif ressource.contenu %}
                        {# Text Content #}
                        <div class="w-full mb-6">
                            <div class="p-6 bg-gray-50 rounded-2xl border border-gray-200">
                                <pre class="whitespace-pre-wrap font-sans text-slate-700 leading-relaxed">{{ ressource.contenu }}</pre>
                            </div>
                        </div>

                    {% else %}
                        {# Generic File Download #}
                        <div class="text-center py-12">
                            <i class="fas fa-file text-6xl text-slate-300 mb-4"></i>
                            <p class="text-lg font-semibold text-slate-500 mb-6">This resource is available for download</p>
                            <a href="{{ ressource.url }}" target="_blank" download class="inline-block px-6 py-3 font-bold text-center uppercase transition-all bg-gradient-to-tl from-slate-600 to-slate-300 text-white rounded-lg cursor-pointer leading-pro text-xs ease-soft-in shadow-soft-md hover:scale-102 active:opacity-85">
                                <i class="fas fa-download mr-2"></i>
                                Download File
                            </a>
                        </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>

</div>
{% endblock %}

