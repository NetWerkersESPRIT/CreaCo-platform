{% extends 'base.html.twig' %}
{% block title %}Admin Dashboard
{% endblock %}

{% block body %}
	<div
		class="w-full px-6 py-6 mx-auto">
		<!-- table 1 -->
		<div class="flex flex-wrap -mx-3 p-6">
			<div class="flex-none w-full max-w-full px-3">
				<div class="relative flex flex-col min-w-0 mb-6 break-words bg-white border-0 border-transparent border-solid shadow-soft-xl rounded-2xl bg-clip-border">
					<div class="p-6 pb-0 mb-0 bg-white border-b-0 border-b-solid rounded-t-2xl border-b-transparent flex justify-between items-center">
						<h6 class="font-bold text-slate-700">Users table</h6>

						{% if pendingCount > 0 %}
							<div class="p-4 bg-orange-100 border-l-4 border-orange-500 text-orange-700 rounded-lg shadow-sm">
								<p class="font-bold text-sm mb-1">Moderation Alert</p>
								<p class="text-xs">
									{{ pendingCount }}
									post{{ pendingCount > 1 ? 's' : '' }}
									awaiting approval.
									<a href="{{ path('admin_post_pending') }}" class="underline font-bold hover:text-orange-900 transition-colors">Go to moderation</a>
								</p>
							</div>
						{% endif %}
					</div>

					<div class="flex-auto px-0 pt-0 pb-2">
						<div class="p-0 overflow-x-auto">
							<table class="items-center w-full mb-0 align-top border-gray-200 text-slate-500">
								<thead class="align-bottom">
									<tr>
										<th class="px-6 py-3 font-bold text-left uppercase align-middle bg-transparent border-b border-gray-200 shadow-none text-xxs border-b-solid tracking-none whitespace-nowrap text-slate-400 opacity-70">User Info</th>
										<th class="px-6 py-3 pl-2 font-bold text-left uppercase align-middle bg-transparent border-b border-gray-200 shadow-none text-xxs border-b-solid tracking-none whitespace-nowrap text-slate-400 opacity-70">Role</th>
										<th class="px-6 py-3 font-bold text-center uppercase align-middle bg-transparent border-b border-gray-200 shadow-none text-xxs border-b-solid tracking-none whitespace-nowrap text-slate-400 opacity-70">Status</th>
										<th class="px-6 py-3 font-bold text-center uppercase align-middle bg-transparent border-b border-gray-200 shadow-none text-xxs border-b-solid tracking-none whitespace-nowrap text-slate-400 opacity-70">Phone Number</th>
										<th class="px-6 py-3 font-semibold capitalize align-middle bg-transparent border-b border-gray-200 border-solid shadow-none tracking-none whitespace-nowrap text-slate-400 opacity-70">Actions</th>
									</tr>
								</thead>
								<tbody>
									{% for user in users %}
										<tr class="hover:bg-gray-50/50 transition-colors">
											<td class="p-2 align-middle bg-transparent border-b whitespace-nowrap shadow-transparent">
												<div class="flex px-2 py-1">
													<div>
														<img src="https://raw.githubusercontent.com/creativetimofficial/public-assets/master/soft-ui-dashboard/assets/img/team-2.jpg" class="inline-flex items-center justify-center mr-4 text-sm text-white transition-all duration-200 ease-soft-in-out h-9 w-9 rounded-xl" alt="{{ user.username }}"/>
													</div>
													<div class="flex flex-col justify-center">
														<h6 class="mb-0 text-sm leading-normal font-bold text-slate-700">{{ user.username }}</h6>
														<p class="mb-0 text-xs leading-tight text-slate-400">{{ user.email }}</p>
													</div>
												</div>
											</td>
											<td class="p-2 align-middle bg-transparent border-b whitespace-nowrap shadow-transparent">
												<span class="text-xs font-semibold leading-tight text-slate-600">{{ user.role }}</span>
											</td>
											<td class="p-2 text-sm leading-normal text-center align-middle bg-transparent border-b whitespace-nowrap shadow-transparent">
												<span class="bg-gradient-to-tl from-green-600 to-lime-400 px-2.5 text-[10px] rounded-1.8 py-1 inline-block whitespace-nowrap text-center align-baseline font-bold uppercase leading-none text-white">Unlocked</span>
											</td>
											<td class="p-2 text-center align-middle bg-transparent border-b whitespace-nowrap shadow-transparent">
												<span class="text-xs font-semibold leading-tight text-slate-400">{{ user.numtel ?: 'N/A' }}</span>
											</td>
											<td class="p-2 align-middle bg-transparent border-b whitespace-nowrap shadow-transparent text-center">
												<div class="flex items-center justify-center gap-2">
													<a href="{{ path('app_user_edit', { id: user.id }) }}" class="inline-block px-4 py-2 text-[10px] font-bold text-white uppercase bg-gradient-to-tl from-blue-600 to-cyan-400 rounded-lg shadow-soft-md hover:scale-102 transition-all">
														<i class="fas fa-edit mr-1"></i>
														Edit
													</a>
													<form action="{{ path('user_delete', { id: user.id }) }}" method="POST" onsubmit="return confirm('Are you sure you want to delete this user?');" class="m-0">
														<button type="submit" class="inline-block px-4 py-2 text-[10px] font-bold text-white uppercase bg-gradient-to-tl from-red-600 to-rose-400 rounded-lg shadow-soft-md hover:scale-102 transition-all border-0 cursor-pointer">
															<i class="fas fa-trash mr-1"></i>
															Delete
														</button>
													</form>
												</div>
											</td>
										</tr>
									{% else %}
										<tr>
											<td colspan="5" class="p-8 text-center text-slate-400 font-bold uppercase text-xs">No users found.</td>
										</tr>
									{% endfor %}
								</tbody>
							</table>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
{% endblock %}
